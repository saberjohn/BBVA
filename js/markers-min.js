/**
* Javascript for custom map
* Copyright (c) Carlos Hugo Gonzalez Castell, http://caarloshugo.info
* Licensed under the MIT license
*/
function setMarkers(e,t){function f(e,t){var n=" - ";for(var r=0;r<t.length;r++){if(t[r].indexOf(n)!=-1){var i=t[r].split(n);if(e<=parseFloat(i[1])){return r}}else{if(e==t[r]){return r}}}}markersCustZC.clearLayers();polylinesGroup.clearLayers();var n=$("#graph-type option:selected").val();if(n=="avg")n="incomes";var r=new L.LatLng(sMarker._latlng.lat,sMarker._latlng.lng);var i=[];jQuery.each(e.zcs,function(e,t){i.push(t[n])});if(i.length==1){i.push(0);i.push(0);i.push(0);i.push(0)}else if(i.length==2){i.push(0);i.push(0);i.push(0)}else if(i.length==3){i.push(0);i.push(0)}else if(i.length==4){i.push(0)}var s=new geostats;s.setSerie(i);var o=new Array("#B6EDF0","#5CA3E6","#2259C7","#0A0A91");var u=s.getClassJenks(4);var a=s.ranges;s.setColors(o);jQuery.each(e.zcs,function(e,t){var i=0;var s=0;L.geoJson(dataGeoJson,{filter:function(t,n){if(t.properties.ZipCode==e){i=t.properties.Lat;s=t.properties.Lon;return t.properties.ZipCode}}});if(i!=0){marker=L.circle([i,s],200,{data:t,zp:e,fillOpacity:.7,opacity:.7,weight:1.2,color:"#223346",fillColor:o[f(t[n],a)]});popupContent='<p><strong>Ingresos</strong><br/><span class="number">'+t.incomes+"</span></p>";popupContent+='<p><strong>Número de tarjetas</strong><br/><span class="number">'+t.num_cards+"</span></p>";popupContent+='<p><strong>Número de pagos</strong><br/><span class="number">'+t.num_payments+"</span></p>";marker.bindPopup(popupContent);point2=new L.LatLng(i,s);pointList=[r,point2];polyLine=new L.Polyline(pointList,{color:"#72954A",weight:1,opacity:.6,smoothFactor:1,clickable:true});polyLine.on("mouseover",function(e){var t=e.target;t.setStyle({color:"#5B7141",opacity:.8,weight:1})});polyLine.on("mouseout",function(e){var t=e.target;t.setStyle({color:"#72954A",weight:1,opacity:.6,smoothFactor:1,clickable:true})});marker.on("click",function(e){$(".number").number(true,2)});polylinesGroup.addLayer(polyLine);markersCustZC.addLayer(marker)}});markersCustZC.addTo(map);polylinesGroup.addTo(map);$(".number").number(true,2)}
